<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bus Bot</title>
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">

<script src="jquery-2.2.3.js"></script>
<link href='http://fonts.googleapis.com/css?family=Economica:700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Palanquin:500' rel='stylesheet' type='text/css'>

<!-- https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=53.2983930,-6.1791055&sensor=true&key=AIzaSyDCCV_eu-x_RV7NxtpEnYgMS158iA6JDHk&rankby=distance&types=bus_station -->
<style type="text/css">

html, body {
	font-family: 'Palanquin', sans-serif;
	font-size: 100%;
	color: #4d4d4f;
	width: 100%;
	height: 100%;
	margin: 0;
	padding: 0;
	overflow: hidden;
	background-color: #fcff00;
}

.container {
	position: absolute;
	top:0;
	left: 0;
	right:0;
	bottom:0;
	padding: 15px;
	overflow-y:scroll;
}

.focus-text {
	font-family: 'Economica', sans-serif;
	font-size: 3em;
	margin: 30% auto;
}

.input {
	width: 100%;
	font-size: 1.25em;
	height: 50px;
	text-align: center;
}

.finePrint {
	font-size: 0.5em;
	padding: 15px 0;
}

.wrapper {
	padding: 15px;
	height: 100%;
    margin: 0 auto;
	text-align: center;
	border: 1px solid #000;
}

.row {
  padding: 20px 0;
  padding-left: 40px;
  margin: 0;
  height: 44px;
  background: url("bus.png") no-repeat center left;
  line-height: 1em;
  font-family: arial, sans-serif;
  border-bottom: 1px solid #000;
}

.row span {
	font-size: 0.6em;
}

.results {
	
    
}

.result {
  position: relative;
  top: 50%;
  transform: translateY(-50%);
  margin: 0;
  padding: 0;
  width: 75%;
  float: left;
  font-size:1.25em
}

.result p {
  margin: 0;
}

.due {
  padding: 0;
  float: right;
  height: 44px;
  width: 44px;
  margin: 0;
  text-align: center;
  line-height: 0.8em;
  color: #fff;
  background: #000;
  border-radius: 50%;
}

.due p {
  position: relative;
  top: 50%;
  transform: translateY(-50%);
  margin: 0;
<!--   margin-top: 10px; -->

}

.controls {
	text-align: center;
	padding: 5px;
}

.pull-right {
	text-align: right;
	float: right;
}

hr {
	border: 1px #717171 solid;
}

.btn {
    display: inline-block;
    padding: 12px 12px;
    font-size: 14px;
    font-weight: 400;
    line-height: 1.42857143;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    -ms-touch-action: manipulation;
    touch-action: manipulation;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    border: 1px solid transparent;
    border-radius: 6px;
	width: 100%;
}

.btn-default {
    color: #333;
    background-color: transparent;
    border-color: #ccc;
}

.btn-success {
    color: #fcff00;
    background-color: #000;
    border-color: #000;
}

.btn-success:active {
    background-color: #98a66e;
}

.btn-default:active {
    background-color: #cdcdcd;
}

</style>

<body>

<div class="container" >
   <section id="fetch">
      <p><input class="input" type="tel" placeholder="Enter Stop Number" id="term" onfocus="this.value='';"/></p>
      <button class="btn btn-success" id="search">FIND BUSES</button>
	  <div id="heading"></div>
	</section>
		<div class="results" id="poster">
		</div>
</div>

</body>

<script>

$(document).ready(function(){

   $('#term').focus(function(){
      var full = $("#poster").has("img").length ? true : false;
      if(full == false){
         $('#poster').empty();
      }
   });

   var getPoster = function(){

        var film = $('#term').val();

         if(film == ''){

            $('#poster').html("<h2 class='loading'>Please enter something in the field.</h2>");

         } else {

            $('#heading').html("<h2 class='loading'>Searching for Buses<br/>at stop "+ film +"</h2><hr />");

            $.getJSON("https://data.dublinked.ie/cgi-bin/rtpi/realtimebusinformation?stopid="+film+"&format=json?callback?", function(json) {

               if (json != "Nothing found."){
					 
						$('#heading').html("<h2 class='loading'>Buses due at stop "+ film +"</h2><hr />");
						
						var len = json.results.length;
						
						for (i=0; i<len; i++){
							
								if (json.results[i].duetime != 'Due'){
								
									$('#poster').append("<div class='row'><div class='result'><p><strong>No. " + json.results[i].route + "</strong><br /><span>To " + json.results[i].destination + "</span></p></div>" + "<div class='due'><p>" + json.results[i].duetime + "<br /><span id='minutes'>min</span></p></div></div>");
									
										} else {
									
									$('#poster').append("<div class='row'><div class='result'><p><strong>No. " + json.results[i].route + "</strong><br /><span>To " + json.results[i].destination + "</span></p></div>" + "<div class='due'><p>" + json.results[i].duetime + "</p></div></div>");
								
								}
						}
                  } else {
				  console.log(i);
						$('#poster').html("<h2>Fail</h2>");
                     };
                  
             });
			 
          }

        return false;
   }

   $('#search').click(getPoster);
   $('#term').keyup(function(event){
       if(event.keyCode == 13){
           getPoster();
       }
   });

});

</script>

</html>
 




